---
title: "Supplementals"
author: "Erin Campbell, Lillianna Righter, Genia Lukin, Elika Bergelson"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r set-up, echo=FALSE, message=FALSE,warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

library(tidyverse)
library(glue)
library(kableExtra)

source("input_quality_preprocessing.R")
lotta_data <- LENA_counts %>%
  left_join(MLUs, by=c("VIHI_ID", "group"))  %>%
  left_join(TTR_calculations, by=c("VIHI_ID", "group")) %>%
  left_join(xds_props_wide %>% 
              dplyr::select(-total), by=c("VIHI_ID", "group")) %>%
  left_join(sensory_props_wide %>% 
              dplyr::select(-total), by=c("VIHI_ID", "group"))%>%
  left_join(subj_CBOI_means, by=c("VIHI_ID", "group")) %>%
  left_join(temporality_props_wide, by=c("VIHI_ID", "group")) %>%
  mutate(ParticipantNumber = as.factor(str_sub(VIHI_ID, 1, 6))) %>%
  mutate(LENA_age_in_days = as.numeric(str_sub(VIHI_ID, 8, length(VIHI_ID))))%>%
  distinct(ParticipantNumber, .keep_all=TRUE)
```

We test whether these properties of the input are associated with children's own productions, and whether these input-production associations differ by group. For each of our input variables, we construct a linear model testing whether child vocalization count is predicted by age, group, [input variable], and an interaction between group and [input variable]. Because conversational turn count relies in part on counts of child vocalizations, we excluded conversational turn count from this set of analyses. In all models, we found significant main effects of age, such that older children produce more vocalizations. We did not find evidence for main effects of group or our input variables or for interactions between group and input variables. 

```{r models}


model_AWC <- lm(CVC ~ LENA_age_in_days + group *AWC, data=lotta_data)
model_CDS <- lm(CVC ~ LENA_age_in_days + group* prop_CDS, data=lotta_data)
model_TTR <- lm(CVC ~ LENA_age_in_days + group*  mean_ttr, data=lotta_data)
model_MLU <- lm(CVC ~ LENA_age_in_days+ group * MLU, data=lotta_data)
model_displaced <- lm(CVC ~ LENA_age_in_days * group+ prop_displaced, data=lotta_data)
model_visual <- lm(CVC ~ LENA_age_in_days + group* prop_Visual, data=lotta_data)


report_model_output <- function(which_model,nickname){
list_of_stuff <- c(nickname, printnum(which_model$coefficients[[2]]), printnum(which_model$coefficients[[3]]), printnum(which_model$coefficients[[4]]),
                   printnum(which_model$coefficients[[5]]))  
  data.frame(list_of_stuff)
  }

bind_cols(c("Input Variable", "Effect of Age (days)", "Effect of Group", "Effect of [Input Variable]", "Interaction between Group and [Input Variable]"),
          report_model_output(model_AWC,"Adult Word Count"), 
          report_model_output(model_CDS,"Prop. Child-Directed Speech"),
          report_model_output(model_TTR,"Type-Token Ratio"),
          report_model_output(model_MLU,"Mean Length of Utterance"),
          report_model_output(model_displaced,"Prop. Displaced Verbs"),
          report_model_output(model_visual,"Prop. Visual Words")) %>% 
  kable(col.names = NULL) %>%
  column_spec(1, width = "1.5in") %>%
    column_spec(2, width = ".75in") %>%
  column_spec(3, width = ".75in") %>%
    column_spec(4, width = ".75in") %>%
    column_spec(5, width = ".75in") %>%
  column_spec(6, width = ".75in") %>%
  column_spec(7, width = ".75in") 
```

To simplify even further, we also present a version where we test for zero-order correlations between each input variable and CVC; see Figure 1. 

```{r corrs, fig.height=8, fig.width=6.5, fig.cap = "Visualizing associations between input variables and child vocalization counts for blind (blue) and sighted (purple) children. Each dot represents one child's recording. Pearson correlation coefficients and p values provided for each variable for each group."}
report_cors <- function(outcome, input,which_group){
  lotta_data_split <- lotta_data %>% filter(group==which_group)
  
  test_results <- cor.test(lotta_data_split[[outcome]], lotta_data_split[[input]]) 
  
  glue("r = {printnum(test_results$statistic)}, p {printp(test_results$p.value, add_equals=TRUE)}")
  
}

AWC_cors<-ggplot(lotta_data, aes(x=AWC_stand, y= CVC, color=group,fill=group)) +
  theme_classic(base_size=12) +
  theme(legend.position="none")+
  geom_point() +
  geom_smooth(method="lm") +
  scale_color_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5")) +
  scale_fill_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5"))+
  annotate("text",x = 400, y = 3600, label = report_cors("CVC","AWC_stand","VI"), color="#ade7f5")+
    annotate("text",x = 400, y = 4000, label = report_cors("CVC","AWC_stand","TD"), color="#b16fff") +
  ylab("Child Vocalization Count")+
  xlab("Adult Word Count / half hour")


CDS_cors <- ggplot(lotta_data, aes(x=prop_CDS, y= CVC, color=group,fill=group)) +
  theme_classic(base_size=12) +
    theme(legend.position="none")+
  geom_point() +
  geom_smooth(method="lm") +
  scale_color_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5")) +
  scale_fill_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5"))+
  annotate("text",x = .35, y = 3600, label = report_cors("CVC","prop_CDS","VI"), color="#ade7f5")+
    annotate("text",x = .35, y = 4000, label = report_cors("CVC","prop_CDS","TD"), color="#b16fff")+
  ylab("Child Vocalization Count")+
  xlab("Prop. Child Directed Speech")

TTR_cors<- ggplot(lotta_data, aes(x=mean_ttr, y= CVC, color=group,fill=group)) +
  theme_classic(base_size=12) +
    theme(legend.position="none")+
  geom_point() +
  geom_smooth(method="lm") +
  scale_color_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5")) +
  scale_fill_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5"))+
  annotate("text",x = .58, y = 3600, label = report_cors("CVC","mean_ttr","VI"), color="#ade7f5")+
    annotate("text",x = .58, y = 4000, label = report_cors("CVC","mean_ttr","TD"), color="#b16fff")+
  ylab("Child Vocalization Count")+
  xlab("Type-Token Ratio")

MLU_cors<-ggplot(lotta_data, aes(x=MLU, y= CVC, color=group,fill=group)) +
  theme_classic(base_size=12) +
    theme(legend.position="none")+
  geom_point() +
  geom_smooth(method="lm") +
  scale_color_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5")) +
  scale_fill_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5"))+
  annotate("text",x = 5, y = 3600, label = report_cors("CVC","MLU","VI"), color="#ade7f5")+
    annotate("text",x = 5, y = 4000, label = report_cors("CVC","MLU","TD"), color="#b16fff")+
  ylab("Child Vocalization Count")+
  xlab("Mean Length of Utterance")

displaced_cors<-ggplot(lotta_data, aes(x=prop_displaced, y= CVC, color=group,fill=group)) +
  theme_classic(base_size=12) +
    theme(legend.position="none")+
  geom_point() +
  geom_smooth(method="lm") +
  scale_color_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5")) +
  scale_fill_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5"))+
  annotate("text",x = .23, y = 3600, label = report_cors("CVC","prop_displaced","VI"), color="#ade7f5")+
    annotate("text",x = .23, y = 4000, label = report_cors("CVC","prop_displaced","TD"), color="#b16fff")+
  ylab("Child Vocalization Count")+
  xlab("Prop. Temporally-Displaced Verbs")

visual_cors<-ggplot(lotta_data, aes(x=prop_Visual, y= CVC, color=group,fill=group)) +
  theme_classic(base_size=12) +
    theme(legend.position="none")+
  geom_point() +
  geom_smooth(method="lm") +
  scale_color_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5")) +
  scale_fill_manual(
    breaks = c("TD", "VI"),
    labels = c("Sighted", "Blind"),
    values = c("#b16fff", "#ade7f5"))+
  annotate("text",x = .09, y = 3600, label = report_cors("CVC","prop_Visual","VI"), color="#ade7f5")+
    annotate("text",x = .09, y = 4000, label = report_cors("CVC","prop_Visual","TD"), color="#b16fff")+
  ylab("Child Vocalization Count")+
  xlab("Prop. Highly Visual Words")

cowplot::plot_grid(AWC_cors, CDS_cors,TTR_cors,MLU_cors,displaced_cors,visual_cors, ncol=2)
```

