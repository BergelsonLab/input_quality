---
title: "input_quality_manuscript"
author: "Erin Campbell & Lillianna Writer"
date: "7/20/2022"
output: html_document
---

```{r libraries}
library(tidyverse)
library(ggplot2)
library(papaja)
```
# Introduction

The early language skills of blind children are highly variable [@campbell_inprep], with some blind children demonstrating age-appropriate vocabulary from the earliest stages of language learning [@landau1985; @CITE], while others experience large and persistent language delays [@CITE]. The causes of this variability remain poorly understood. Clearly, blindness in and of itself, is not a death knell for language development--many blind children are on track, or even ahead! But the higher incidence of severe language delays in this population yields questions about the process of language development in the absence of visual perception: what contributes to language outcomes among young blind children? There are multiple possible contributors, including characteristics of the child (e.g., visual characteristics, comorbid conditions, gender) as well as characteristics of the environment (e.g., access to early intervention services; school setting). Here, we do a deep dive into the characteristics of the language environment of blind children and its influence on language development. 

Among both typically-developing children and children with developmental differences, language input is an important predictor of language outcomes [@CITE]. At a coarse level, children who are exposed to more speech (or sign @CITE) tend to have better language outcomes [@gilkerson2018; @huttenlocher1991; @rowe2008; ]  

Language quality is also important.
Lexical diversity: Toddlers who are exposed to greater diversity of words in their language input tend to have larger vocabulary scores [@rowe2012].
MLU: 

Language input quantity and quality are also interrelated: parents who talk more also tend to provide more lexical diversity [@hoff2002].


For blind children, language input may play an even more important role [@campbell2022]. In the absence of visual input, language is an important source of information about the world. 
Linguistic structure also provides cues to word meaning that may be lost without visual cues, such as joint (visual) attention or pointing. All that said, language input may differ for blind children relative to sighted children

Speakers tailor input to communicate efficiently with the listener [@grice1975]. Child-directed speech is one example--whereby parents speak to young children with exaggerated prosody, slower speech rate, and increased vowel clarity [@CITE], which appears to be helpful to the young language learner [@CITE]. Communicative tailoring is also common in language input to children with disabilities, who tend to receive simplified, more directive language input, and less interactive input compared to typically-developing children [@dirks2019; @yoshinaga-itano2020]. 

Furthermore, speakers collaborating on a task will also adjust their conversation in accordance with the listener's visual access [@gergle2004; @grigoroglou2016]. Speakers aim to provide the information their listeners need [@grice1975], providing verbally providing visually-absent cues [@jaraettinger2021; @hawkins2021; @rubio-fernandez2019], but avoiding redundant visual description [@ostarek2019].




However, in child-directed speech to a blind infant, communication partners may restrict conversation to things that the child is currently engaged with [@anderson1993].


In this study, we examine daylong recordings of naturalistic at-home language interactions between caregivers and their blind or sighted children. 

```{r load-transcripts}
#read in data that has been mass exported via ELAN; add informative column names
single_column_with_names <- read_delim("/Volumes/pn-opus/VIHI/WorkingFiles/fake_VI_july26_no_separate_column.txt", 
     delim = "\t", escape_double = FALSE, 
     trim_ws = TRUE,col_names = FALSE) %>%
  rename(tier=X1,
         participant=X2,
         onset_ms=X3,
         offset_ms=X4,
         duration=X5,
         utterance=X6,
         filename=X7,
         filepath=X8)

#wrangle data so that each utterance has a single row, all participant labels appear in a single column, all utterance transcriptions in a single column, xds annotations appear in a single column, all PI annotations appear in a single column)
try_wide <- pivot_wider(single_column_with_names, names_from = "tier", values_from = "utterance") %>%
  unite("xds", contains("xds@"), remove = TRUE, na.rm = TRUE) %>%
  unite("PI", contains("PI"), remove = TRUE, na.rm = TRUE) %>%
  unite("utterance", c("CHI","UC1","FA1", "FA2", "FA3","FA4","FA5", "FAE", "MA1", "MA2","MA3", "MC1", "FC1", "EE1"), remove = TRUE, na.rm = TRUE)

```


```{r}
### ADS/CDS proportion

#get number of counts per each xds type by file
CDS_proportion <- try_wide %>%
  filter(xds %in% c("C","A","B","P", "O", "U"))%>%
  group_by(filename, xds) %>%
  summarise(counts=n())

#just wanna check how many utterances total
mega_total <- sum(CDS_proportion$counts)

#find total number of utterances per file
CDS_total_input_utterances <- try_wide %>%
  filter(xds %in% c("C","A","B","P", "O", "U"))%>%
  group_by(filename) %>%
  summarise(total_utts=n())

#just checking that the number is the same bc i don't trust myself
mega_total2 <- sum(CDS_total_input_utterances$total_utts)

#breakdown by addressee all VI kids as a group
VI_group_props <- try_wide %>%
  filter(xds %in% c("C","A","B","P", "O", "U"))%>%
  group_by(xds) %>%
  summarise(big_number=n())


#lets create a function to convert things into percents (I stole this obvi)
percent <- function(x, digits = 2, format = "f", ...) {      # Create user-defined function
  paste0(formatC(x * 100, format = format, digits = digits, ...), "%")
}

#and now a full table with number of utts per addressee category, totaly utts for that file, and what the percent of each cat comes out as for each kid
proportion_table <- left_join(CDS_proportion, CDS_total_input_utterances)%>%
  mutate(incidence_percent = percent(counts/total_utts))

#this is just the same as the group props but with percentages
VI_group_proportion_table <- VI_group_props %>%
  mutate(group_percent = percent(big_number/mega_total))


ggplot(CDS_proportion, aes(fill = xds, y=counts, x=filename)) +
  geom_bar(position="fill", stat="identity") +
  ggtitle("Proportion of Addressee by Recording") +
  xlab("Recording") + ylab ("Proportion, by number of utterances") +
  scale_fill_discrete(labels=c('Adult-directed', 'Both child and adult', 'Child-directed', 'Other', 'Pet-directed', 'Unsure')) + theme(axis.text.x = element_text(face="bold", color="#000000", size=9, angle=45))

#I need to rename filenames to something that's not the same as lab-internal subj num
```


```{r CDS-ADS-props}
#Overall VI CDS/ADS proportion graph
ggplot(VI_group_proportion_table, aes(fill = xds, y= big_number, x = "")) +
  geom_bar(position = "stack", stat = "identity") + ggtitle("Proportion by Addressee in Speech heard by VI Children") +
  geom_text(aes(label=group_percent), position=position_stack(vjust=0.5)) +
  xlab("All VI children") + ylab ("Proportion, by number of utterances") +
  scale_fill_discrete(labels=c('Adult-directed', 'Both child and adult', 'Child-directed', 'Other', 'Pet-directed', 'Unsure'))
```

```{r}
#we will do the same as above with TD matches (gonna have to do some filtering)
#and then a z-test to compare proportions of CDS

```



## Methods

### Participants
`r CDS_proportions %>% filter(group=="VI") %>% distinct(filename) %>% nrow()` blind infants and their families participated in this study. Blind participants were recruited through opthamologist referral, preschools, early intervention programs, social media, and word of mouth. To be eligible for this study, participants had to be 6--30 months old, have no additional disabilities (developmental delays; intellectual disabilities, or hearing loss), and be exposed to $\geq$ 75% English at home. Given the wide age range of the study, to control for age, each blind participant was matched to a sighted partcipicant, based on age ($\pm$ 6 weeks), gender, maternal education ($\pm$ one education level: less than high school diploma, high school diploma, some college / Associate's, Bachelor's, graduate school), and number of siblings ($\pm$ 1 sibling). When more than one match was available, we prioritized matching the blind participants as closely as possible on each characteristics in the preceding order. Caregivers were asked to complete a demographics survey and the MacArthur-Bates Communicative Development Inventory [CDI; @fenson1994] within one week of the home language recording. See XXX for sample characteristics.

```{r participant-characteristics}
```

### Recording Procedure

Eligible families were asked to complete two surveys and complete a daylong home language recording. For the recording portion of the study, caregivers of participating infants received a LENA wearable audio recorder [@ganek2016] and vest. They were instructed to place the recorder in the vest on the day of their scheduled recording and put the vest on their child from the time they woke up until the recorder automatically shut off after 16 hours (setting vest nearby during bath, nap, and car times). They were also instructed how to pause the recording at any time, but asked to keep these pauses to a minimum. Actual recording length ranged from RANGE (XXX mean, SD). 

### Processing
<!-- I don't actually know how these are processed up front so I'll come back to this -->
Audio recordings were processed by LENA software (gives you an its? idk). Each recording was then run through an automated sampler that selected 15- non-overlapping 5-minute segments, randomly distributed across the duration of the file. The process output a codeable ELAN file (.eaf, CITE). Each segment consists of 2 core minutes of annotated time, with 2 minutes of listenable context marked out preceding the annotation clip and 1 minute of additional context following the annotation clip. Each file therefore contains 30 minutes of coded recording time and 75 minutes of total time listened (#isn't there one where that's not true??)  Because these segments were sampled randomly, and not on a high-volubility measure such as conversational turns or adult speech density, the amount of time with codeable speech input varied for each recording. Indeed, across participants (FIND A WAY TO DO MATH WITH # SEGMENTS THAT ARE SILENT) of the 2-minute coding segments contained no speech at all. 

### Annotation

Trained annotators listened through each 2-minute segment plus its surrounding context and coded it using the Analyzing Child Language Experiences around the World (ACLEW) Daylong Audio Recording of Children's Linguistic Environments (DARCLE) annotation scheme [@soderstrom2021]. Prior to annotating lab data, annotators are trained on previously coded samples of child recordings and are required to reach 95% overall agreement with the gold standard version of the file for three different age ranges: 0-7 months, 8-18 months, and 19-36 months. For more information about this annotation scheme and the larger project, please see the ACLEW homepage (https://sites.google.com/view/aclewdid/home). Following the first pass, all files were checked by a highly-trained "superchecker" (second author on this paper, Lilli "Always Right" Righter) to ensure the consistency of annotations. (are we gonna do reliability? I don't want to lol)

This annotation scheme is designed to capture both utterances by the target child (henceforth referred to as CHI) and speech in the child's environment, including adults, other children, and pre-recorded electronic speech (e.g. toys, television, the radio). Annotators segment the duration of each utterance on a separate coding tier for each unique speaker (exceptions: all electronic speech is coded on the same tier, and some speakers who appear briefly in these files were not easily distinguishable from others by annotators naive to their identities, so they may be concatenated on the same tier). Speech by people other than the target child is transcribed using an adapted version of CHAT transcription style [@macwhinney2019], dubbed minCHAT for the ACLEW project [@soderstrom2021]. Because the majority of target children in the project are pre-lexical or phonetically immature, CHI utterances are not transcribed. 

Each utterance is coded for additional linguistic properties from a set of pre-determined categories. CHI utterances are coded for vocal maturity, lexical status, and multi-word status. Vocal maturity classifies utterances into the following categories: laughing; crying; canonical syllables that contain a consonant-like and vowel-like sound component, including both babbling and identifiable words; non-canonical syllables, which do not contain both consonant and vowel portions, or which do not transition between them in a speech-like way; and unsure, when the vocalization type is unclear. Each vocalization that contains canonical syllables is then coded for lexical status, either containing an identifiable lexical item or not. Finally, each utterance with a lexical item is coded for multi-word status, whether or not it contains more than one unique word type.

Environmental speech is coded for the addressee of each utterance: speech directed to a child, whether or not it is directed to the target child; adult-directed speech; speech directed to both an adult and a child; speech directed to pets or other animals; unclear addressee; or speech directed towards a recipient that doesn't fit into another category (e.g. voice control of Siri or Alexa, speech to a metaphysical entity). 

Following ACLEW DARCLE style annotation [@soderstrom2021], each file was converted into a CHAT file [@macwhinney2018] to use the CLAN automated mean length of utterance (MLU) analysis for each speaker. This analysis finds the average number of morphemes per utterance, using the eng MOR grammar dictionary [@macwhinney2018].

# Discussion
Might be hard to provide useful input due to differences in nonverbal communication between blind infants and their sighted caregivers. Young children born with visual impairment may differ in their nonverbal communication cues. For example,  [@preisler1995] found that 6--9-month-old blind infants communicated using leaning, eyebrow raising, and lip movements. Caregivers who responded to these nonverbal cues as conversational turns had higher rates of interaction with the child, higher rates of appropriate response, and increased positive affect. By contrast, caregivers who did not recognize these signals as communicative had lower rates of response and increased negative affect.

